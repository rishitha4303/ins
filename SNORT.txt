 Step 0: Install Snort

```bash
sudo apt install snort
```

---

Step 1: Create the rules folder + local.rules

Snort needs a folder where your custom rules will live.

```bash
sudo mkdir -p /etc/snort/rules
sudo touch /etc/snort/rules/local.rules
```

✔ creates the folder
✔ creates an empty rules file

---

Step 2: Add custom rules**

Open the rules file:

```bash
sudo nano /etc/snort/rules/local.rules
```

Paste ANY of these (or all three):

```
alert tcp any any -> any any (msg:"TCP attack"; content:"attack"; nocase; sid:1000001; rev:1;)
alert udp any any -> any 12345 (msg:"UDP attack"; content:"attack"; nocase; sid:1000002; rev:1;)
alert ip any any -> any any (msg:"ANY IP attack"; content:"attack"; nocase; sid:1000003; rev:1;)
```

Save → `CTRL+O`
Exit → `CTRL+X`

---
Step 3: Make sure Snort loads local.rules

Check snort.conf:

```bash
sudo grep -E "RULE_PATH|local.rules" /etc/snort/snort.conf -n
```

You MUST see something like:

```
var RULE_PATH /etc/snort/rules
include $RULE_PATH/local.rules
```

If `include` is missing, open:

```bash
sudo nano /etc/snort/snort.conf
```

Add this line:

```
include $RULE_PATH/local.rules
```

Save and exit.

---

Step 4: Validate Snort config

Always test before running:

```bash
sudo snort -T -c /etc/snort/snort.conf
```

Expected message:

```
Snort successfully validated the configuration!
```

If you see an error → fix the file it mentions.

---

Step 5: Start Snort (Terminal A)**

Run Snort and monitor your local machine:

```bash
sudo snort -A console -q -c /etc/snort/snort.conf -i lo
```

✔ `-A console` → show alerts in terminal
✔ `-i lo` → listen on loopback interface
✔ `-q` → quiet mode except alerts

**Keep this terminal open.**

---

Step 6: Trigger the alert (Terminal B)**

Send a test packet containing the word `"attack"`:

```bash
echo "this is an attack" | nc -u -w1 127.0.0.1 12345
```

Snort window (Terminal A) should print something like:

```
[**] UDP attack [**]
```

